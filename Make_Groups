SELECT First, Last
FROM (SELECT 
CASE WHEN deci='first_row' THEN RollNo END AS First,
CASE WHEN deci='last_row' THEN RollNo END AS Last
FROM (SELECT b.*,
CASE WHEN (mod(rr_rank,3)=0) THEN 'last_row' 
WHEN (mod((lead(rr_rank,2) OVER ()),3)=0) THEN 'first_row' END AS deci
FROM (SELECT RollNo, rr,
rank() over (order by rr asc) as rr_rank
FROM (SELECT  RollNo , Rank AS rr FROM Students) a) b) c
WHERE deci IS NOT NULL) d
GROUP BY First,Last;
